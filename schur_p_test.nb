(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51483,       1210]
NotebookOptionsPosition[     50713,       1189]
NotebookOutlinePosition[     51085,       1205]
CellTagsIndexPosition[     51042,       1202]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 FormBox[
  RowBox[{"Title", ":", " ", 
   RowBox[{
   "Schur", " ", "P", " ", "Polynomial", " ", "Lorentzian", " ", "Test"}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{
   RowBox[{"Author", ":", " ", 
    RowBox[{"Avery", " ", 
     RowBox[{"St", ".", " ", "Dizier"}]}]}], "\[IndentingNewLine]"}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{
  "This", " ", "notebook", " ", "contains", " ", "code", " ", "to", " ", 
   "calculate", " ", "normalized", " ", "Schur", " ", "P", " ", "polynomials",
    " ", "and", " ", "test", " ", "that", " ", "they", " ", "are", " ", 
   RowBox[{"Lorentzian", 
    StyleBox[".",
     FontSlant->"Plain"]}]}], TraditionalForm]}], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.770250159779748*^9, 3.7702502335424232`*^9}, {
  3.7702562408952875`*^9, 3.770256310225111*^9}, {3.770256454786835*^9, 
  3.770256460102127*^9}, {3.7702838939401565`*^9, 3.770283933827541*^9}, {
  3.770286790718797*^9, 3.770286814187315*^9}, {3.7702884712830305`*^9, 
  3.770288471505627*^9}, {3.7702885350426707`*^9, 3.7702885409445705`*^9}, {
  3.7702888882782173`*^9, 
  3.7702888903843093`*^9}},ExpressionUUID->"64c7bbb2-096e-48f8-a349-\
50960e2bbb74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
    "**"}], "*******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Global", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", 
     RowBox[{"x", ",", "t"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "=", "x"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "A", " ", "variable", " ", "name", " ", "for", " ", "multivariable", " ",
       "polynomial", " ", "variables"}], ",", " ", 
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"x", "[", "2", "]"}], ",", "..."}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", "t"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "A", " ", "variable", " ", "for", " ", "internal", " ", "computations"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Protect", "[", 
     RowBox[{"x", ",", "t"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "*******)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "*******)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Supporting", " ", "methods"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Exponents", "[", 
      RowBox[{"f", ",", "vars"}], "]"}], " ", "returns", " ", "the", " ", 
     "list", " ", "of", " ", "exponent", " ", "vectors", " ", "of", " ", 
     "terms", " ", "appearing", " ", "in", " ", "the", " ", "polynomial", " ",
      "f", " ", "in", " ", "variables", " ", "vars", " ", "with", " ", 
     "nonzero", " ", 
     RowBox[{"coefficient", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Exponents", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"vars_", "?", "VectorQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "replace", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"replace", "[", 
          RowBox[{"a_", "->", "b_"}], "]"}], ":=", "a"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"replace", "/@", 
          RowBox[{"CoefficientRules", "[", 
           RowBox[{"f", ",", "vars"}], "]"}]}], "]"}], ";"}]}], "\n", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Coefficients", "[", 
      RowBox[{"f", ",", "vars"}], "]"}], " ", "returns", " ", "the", " ", 
     "list", " ", "of", " ", "coefficients", " ", "of", " ", "terms", " ", 
     "appearing", " ", "in", " ", "the", " ", "polynomial", " ", "f", " ", 
     "in", " ", "variables", " ", 
     RowBox[{"vars", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficients", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"vars_", "?", "VectorQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "replace", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"replace", "[", 
          RowBox[{"a_", "->", "b_"}], "]"}], ":=", "b"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"replace", "/@", 
          RowBox[{"CoefficientRules", "[", 
           RowBox[{"f", ",", "vars"}], "]"}]}], "]"}], ";"}]}], "\n", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"NormalizePolynomial", "[", "f", "]"}], " ", "returns", " ", 
      "the", " ", "normalization", " ", "of", " ", "the", " ", "polynomial", 
      " ", 
      RowBox[{"f", ".", " ", "Specifically"}]}], ",", " ", 
     RowBox[{
     "each", " ", "term", " ", "is", " ", "divided", " ", "by", " ", "the", 
      " ", "product", " ", "of", " ", "factorials", " ", "of", " ", "its", 
      " ", "exponent", " ", 
      RowBox[{"vector", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NormalizePolynomial", "[", "f_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vars", ",", "monomials", ",", "exps", ",", "normalizers"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vars", "=", 
         RowBox[{"Variables", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"monomials", "=", 
         RowBox[{"MonomialList", "[", "f", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"exps", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Exponents", "[", 
              RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "monomials"}], 
           ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"normalizers", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Times", ",", 
           RowBox[{"Map", "[", 
            RowBox[{"Factorial", ",", "exps", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"monomials", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", 
            RowBox[{"normalizers", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "monomials", "]"}]}], "}"}]}], "]"}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"PartitionQ", "[", "\[Lambda]", "]"}], " ", "checks", " ", 
     "that", " ", "is", " ", "a", " ", "weakly", " ", "decreasing", " ", 
     "sequence", " ", "of", " ", "nonnegative", " ", 
     RowBox[{"integers", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PartitionQ", "[", "\[Lambda]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"VectorQ", "[", 
       RowBox[{"\[Lambda]", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Positive", "[", "#", "]"}], "||", 
            RowBox[{"#", "\[Equal]", "0"}]}], ")"}]}], "&"}]}], "]"}], "&&", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{"\[Lambda]", ",", 
         RowBox[{
          RowBox[{"-", "#"}], "&"}]}], "]"}], "\[Equal]", "\[Lambda]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "*******)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "*******)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Lorentzian", " ", "test"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"QuadraticFormToMatrix", "[", 
      RowBox[{"f", ",", "n"}], "]"}], " ", "takes", " ", "a", " ", 
     "quadratic", " ", "form", " ", "f", " ", "and", " ", "number", " ", "of",
      " ", "variables", " ", "n", " ", "and", " ", "computes", " ", "the", 
     " ", "n", " ", "by", " ", "n", " ", "matrix", " ", "corresponding", " ", 
     "to", " ", 
     RowBox[{"f", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"QuadraticFormToMatrix", "[", 
      RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexvaluepairs", ",", "A"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerQ", "[", "f", "]"}], "&&", 
           RowBox[{"f", "\[Equal]", "0"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indexvaluepairs", "=", 
         RowBox[{
          RowBox[{"MonomialList", "[", "f", "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"a_", " ", 
              RowBox[{"x", "[", "i_", "]"}], " ", 
              RowBox[{"x", "[", "j_", "]"}]}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j", ",", 
               RowBox[{"a", "/", "2"}]}], "}"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "i_", "]"}], " ", 
              RowBox[{"x", "[", "j_", "]"}]}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j", ",", 
               RowBox[{"1", "/", "2"}]}], "}"}]}], ",", 
            RowBox[{
             RowBox[{"a_", " ", 
              RowBox[{
               RowBox[{"x", "[", "i_", "]"}], "^", "2"}]}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "i", ",", "a"}], "}"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "i_", "]"}], "^", "2"}], "\[RuleDelayed]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "i", ",", "1"}], "}"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"ivp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"ivp", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
            RowBox[{"ivp", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"ivp", ",", "indexvaluepairs"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"s", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"s", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{"Reverse", "/@", 
             RowBox[{"Subsets", "[", 
              RowBox[{
               RowBox[{"Range", "[", "n", "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "A", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "SubmodularVectorQ", " ", "takes", " ", "a", " ", "list", " ", "zvect", 
     " ", "of", " ", "length", " ", 
     SuperscriptBox["2", "k"], " ", "for", " ", "some", " ", "k", " ", "and", 
     " ", "treats", " ", "it", " ", "as", " ", "a", " ", "function", " ", 
     "on", " ", "subsets", " ", 
     RowBox[{"of", " ", "[", "k", "]"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"with", " ", "inputs", " ", "in", " ", "order", " ", 
        RowBox[{"Subsets", "[", 
         RowBox[{"Range", "[", "k", "]"}], "]"}]}], ")"}], ".", " ", 
      "Returns"}], " ", "True", " ", "if", " ", "this", " ", "function", " ", 
     "is", " ", 
     RowBox[{"submodular", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SubmodularVectorQ", "[", 
      RowBox[{"zvect_", "?", "VectorQ"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "len", ",", "I", ",", "J", ",", "posI", ",", "posJ", ",", "posIuJ", 
         ",", "posIJ", ",", "results", ",", "subsets", ",", "pairs", ",", 
         "ddresults"}], "}"}], ",", 
       RowBox[{
        RowBox[{"len", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"Length", "[", "zvect", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"subsets", "=", 
         RowBox[{"Subsets", "[", 
          RowBox[{"Range", "[", "len", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pairs", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"subsets", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"results", "=", 
         RowBox[{
          RowBox[{"Reap", "[", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"I", ",", "J"}], "}"}], "=", "set"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"posI", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"subsets", ",", "I"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"posJ", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"subsets", ",", "J"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"posIuJ", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"subsets", ",", 
                  RowBox[{"Union", "[", 
                   RowBox[{"I", ",", "J"}], "]"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"posIJ", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"subsets", ",", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{"I", ",", "J"}], "]"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Sow", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"zvect", "[", 
                  RowBox[{"[", "posI", "]"}], "]"}], "+", 
                 RowBox[{"zvect", "[", 
                  RowBox[{"[", "posJ", "]"}], "]"}]}], "\[GreaterEqual]", 
                RowBox[{
                 RowBox[{"zvect", "[", 
                  RowBox[{"[", "posIJ", "]"}], "]"}], "+", 
                 RowBox[{"zvect", "[", 
                  RowBox[{"[", "posIuJ", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
             RowBox[{"{", 
              RowBox[{"set", ",", "pairs"}], "}"}]}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ddresults", "=", 
         RowBox[{"DeleteDuplicates", "[", "results", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "ddresults", "]"}], "\[Equal]", "1"}], "&&", 
          RowBox[{
           RowBox[{"ddresults", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "True"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\n", 
   RowBox[{"(*", 
    RowBox[{
    "GeneralizedPermutahedronQ", " ", "takes", " ", "as", " ", "input", " ", 
     "a", " ", "list", " ", "of", " ", "vectors", " ", "and", " ", "checks", 
     " ", "that", " ", "it", " ", "is", " ", "exactly", " ", "the", " ", 
     "set", " ", "of", " ", "integer", " ", "points", " ", "in", " ", "a", 
     " ", "generalized", " ", 
     RowBox[{"permutahedron", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GeneralizedPermutahedronQ", "[", 
      RowBox[{"list_", "?", "MatrixQ"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "subsets", ",", "upperbound", ",", "zvector", ",", "zz", ",", 
         "inequalities", ",", "answers", ",", "submodular", ",", 
         "saturated"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"list", "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MatrixQ", "[", 
            RowBox[{"list", ",", "IntegerQ"}], "]"}]}], ",", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Total", "/@", "list"}], "]"}], "]"}], "\[NotEqual]", 
           "1"}], ",", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"subsets", "=", 
         RowBox[{"Subsets", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"upperbound", "[", "I_", "]"}], ":=", 
         RowBox[{"Max", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"Total", ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "I"}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"zvector", "=", 
         RowBox[{"upperbound", "/@", "subsets"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"submodular", "=", 
         RowBox[{"SubmodularVectorQ", "[", "zvector", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "submodular"}], ",", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"zz", "[", "set_", "]"}], ":=", 
         RowBox[{"zvector", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"subsets", ",", "set"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"inequalities", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "I"}], "}"}]}], "]"}], "\[LessEqual]", 
            RowBox[{"zz", "[", "I", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"I", ",", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{"Delete", "[", 
                RowBox[{"subsets", ",", "1"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"inequalities", ",", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"t", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"list", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "\[Equal]", 
           RowBox[{"zz", "[", 
            RowBox[{"subsets", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"answers", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"t", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"list", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "/.", 
          RowBox[{"Solve", "[", 
           RowBox[{"inequalities", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"t", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", "Integers"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"saturated", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sort", "[", "answers", "]"}], "\[Equal]", 
           RowBox[{"Sort", "[", 
            RowBox[{"DeleteDuplicates", "[", "list", "]"}], "]"}]}], ")"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "saturated", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MConvexSupportQ", "[", "f", "]"}], " ", "tests", " ", "that", 
       " ", "the", " ", "support", " ", "of", " ", "the", " ", "polynomial", 
       " ", "f", " ", "is", " ", "M"}], "-", 
      RowBox[{
       RowBox[{"convex", ".", " ", "That"}], " ", "is"}]}], ",", " ", 
     RowBox[{
     "whether", " ", "the", " ", "Newton", " ", "polytope", " ", "of", " ", 
      "f", " ", "is", " ", "a", " ", "generalized", " ", "permutahedron", " ",
       "and", " ", "is", " ", 
      RowBox[{"saturated", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MConvexSupportQ", "[", "f_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vars", ",", "exps"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vars", "=", 
         RowBox[{"Variables", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"exps", "=", 
         RowBox[{"Exponents", "[", 
          RowBox[{"f", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"GeneralizedPermutahedronQ", "[", "exps", "]"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"LorentzianPolynomialQ", "[", "h", "]"}], " ", "checks", " ", 
      "whether", " ", "the", " ", "polynomial", " ", "h", " ", "is", " ", 
      RowBox[{"Lorentzian", ".", " ", "That"}], " ", "is", " ", "whether", 
      " ", "h", " ", "has", " ", "nonnegative", " ", "coefficients"}], ",", 
     " ", 
     RowBox[{"M", "-", 
      RowBox[{"convex", " ", "support"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "and", " ", "satisfies", " ", "the", " ", "relevant", " ", "derivative",
        " ", 
       RowBox[{"condition", ".", " ", "Nonnegative"}], " ", "coefficient", 
       " ", "test", " ", "and", " ", "M"}], "-", 
      RowBox[{
      "convexity", " ", "test", " ", "are", " ", "commented", " ", "out", " ",
        "here", " ", "since", " ", "Schur", " ", "P", " ", "polynomials", " ",
        "are", " ", "known", " ", "to", " ", "have", " ", "nonnegative", " ", 
       "coefficients", " ", "and", " ", "M"}], "-", 
      RowBox[{"convex", " ", 
       RowBox[{"support", "."}]}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LorentzianPolynomialQ", "[", "h_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "oldvars", ",", "n", ",", "vars", ",", "f", ",", "degrees", ",", 
         "homogeneous", ",", "coeffs", ",", "nonnegativecoeffs", ",", "d", 
         ",", "g", ",", "A", ",", "mconvexsupport", ",", "increasingTuples", 
         ",", "tuples", ",", "eigenvalues", ",", "spectral"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "h", "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"h", "\[GreaterEqual]", "0"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oldvars", "=", 
         RowBox[{"Variables", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "oldvars", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vars", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"x", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"f", "=", 
         RowBox[{"h", "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{"oldvars", "\[Rule]", "vars"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"degrees", "=", 
         RowBox[{"Total", "/@", 
          RowBox[{"Exponents", "[", 
           RowBox[{"f", ",", "vars"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"homogeneous", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", "degrees", "]"}], "]"}], "==", 
           "1"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "homogeneous"}], ",", 
          RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coeffs", "=", 
         RowBox[{"Coefficients", "[", 
          RowBox[{"f", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nonnegativecoeffs", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"NumberQ", "[", "#", "]"}], "&&", 
                 RowBox[{"#", "\[GreaterEqual]", "0"}]}], "&"}], "/@", 
               "coeffs"}], "]"}], "\[Equal]", 
             RowBox[{"{", "True", "}"}]}], ")"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "nonnegativecoeffs"}], ",", 
            RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"degrees", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"d", "\[Equal]", "1"}], ",", 
          RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"d", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"g", "=", "f"}], ";", "\[IndentingNewLine]", 
           RowBox[{"A", "=", 
            RowBox[{"QuadraticFormToMatrix", "[", 
             RowBox[{"g", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Eigenvalues", "[", "A", "]"}], "//", "N"}], ",", 
                "Positive"}], "]"}], "]"}], "\[LessEqual]", "1"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mconvexsupport", "=", 
           RowBox[{"MConvexSupportQ", "[", "f", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "mconvexsupport"}], ",", 
            RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "increasingTuples", " ", "is", " ", "due", " ", "to", " ", 
           "MathematicaStackExchange", " ", "user", " ", 
           RowBox[{
           "\"\<halirutan\>\"", ".", " ", "\[IndentingNewLine]", "See"}], " ", 
           RowBox[{"https", ":"}]}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
              "questions"}], "/", "42278"}], "/", "non"}], "-", "descending", 
           "-", 
           RowBox[{"tuples", " ", "for", " ", 
            RowBox[{"source", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"increasingTuples", "[", 
          RowBox[{"l_List", ",", "m_"}], "]"}], ":=", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"iter", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#2", ",", "#1", ",", 
                 RowBox[{"Length", "[", "l", "]"}]}], "}"}], "&"}], "@@@", 
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"Array", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Unique", "[", "]"}], "&"}], ",", "m"}], "]"}], 
                  ",", "1"}], "]"}], ",", "2", ",", "1"}], "]"}]}]}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Part", "[", 
              RowBox[{"l", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "@@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"iter", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"Sequence", "@@", "iter"}]}], "}"}]}], ",", 
              RowBox[{"m", "-", "1"}]}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tuples", "=", 
         RowBox[{"increasingTuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", "n", "]"}], ",", 
           RowBox[{"d", "-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"spectral", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "=", "f"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"g", "=", 
               RowBox[{"D", "[", 
                RowBox[{"g", ",", 
                 RowBox[{"x", "[", "i", "]"}]}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Reverse", "[", "t", "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"A", "=", 
            RowBox[{"QuadraticFormToMatrix", "[", 
             RowBox[{"g", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"eigenvalues", "=", 
            RowBox[{
             RowBox[{"Eigenvalues", "[", "A", "]"}], "//", "N"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"spectral", "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Select", "[", 
                RowBox[{"eigenvalues", ",", 
                 RowBox[{
                  RowBox[{"Positive", "[", "#", "]"}], "&"}]}], "]"}], "]"}], 
              "\[LessEqual]", "1"}], ")"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "spectral"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "tuples"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "spectral", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "*******)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "*******)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Polynomial", " ", "computation", " ", "method"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Uses", " ", "Pfaffian", " ", 
     RowBox[{"formula", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SchurPPolynomial", "[", 
      RowBox[{"lambda1_", "?", "PartitionQ"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "zeros", ",", "dlambda", ",", "l", ",", "lambda", ",", "n", ",", 
         "schurP"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"zeros", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"Count", "[", 
             RowBox[{"lambda1", ",", "0"}], "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dlambda", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"lambda1", ",", "0"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"l", "=", 
         RowBox[{"Length", "[", "dlambda", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lambda", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"dlambda", ",", "zeros"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "lambda", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"schurP", "=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "l"}], ")"}], "!"}], ")"}]}], " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", "i", "]"}], "^", 
                   RowBox[{"lambda", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], " ", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"s", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"x", "[", 
                    RowBox[{"s", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"s", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
                    RowBox[{"x", "[", 
                    RowBox[{"s", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}], ",", 
                    "1"}], "]"}]}], "}"}]}], "]"}]}], ")"}], "/.", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "[", "k", "]"}], "\[Rule]", 
                 RowBox[{"x", "[", 
                  RowBox[{"w", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ")"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"w", ",", 
              RowBox[{"Permutations", "[", 
               RowBox[{"Range", "[", "n", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"schurP", "=", 
         RowBox[{"Expand", "[", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"Together", "[", "schurP", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "schurP", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "*******)"}]}]}]], "Input",
 CellChangeTimes->{{3.7702401175183783`*^9, 3.770240119907844*^9}, {
   3.770242077912565*^9, 3.7702421518007*^9}, {3.770242265319602*^9, 
   3.770242369853421*^9}, {3.770242404406146*^9, 3.770242585463557*^9}, {
   3.7702426738755636`*^9, 3.7702429045528126`*^9}, {3.7702429430380635`*^9, 
   3.7702431589054856`*^9}, {3.770243244227669*^9, 3.7702435441934004`*^9}, {
   3.770243577489069*^9, 3.770243621784171*^9}, {3.7702446132126293`*^9, 
   3.770244775420302*^9}, {3.7702448244126406`*^9, 3.7702448778696966`*^9}, {
   3.770244941964652*^9, 3.7702451998432913`*^9}, {3.7702452431147127`*^9, 
   3.770245279405016*^9}, {3.7702455890793076`*^9, 3.770245608969892*^9}, {
   3.770245659669544*^9, 3.770245780498519*^9}, {3.770245815323762*^9, 
   3.7702460132157383`*^9}, {3.770246047855503*^9, 3.7702460551769204`*^9}, {
   3.7702460934178047`*^9, 3.770246175489154*^9}, {3.770246219321449*^9, 
   3.7702462536211133`*^9}, {3.770246288463702*^9, 3.7702463869607267`*^9}, {
   3.770246466009062*^9, 3.7702465158614874`*^9}, {3.7702465601522484`*^9, 
   3.770246685152599*^9}, {3.7702467282354794`*^9, 3.770246853363511*^9}, {
   3.770246930429452*^9, 3.770246967919568*^9}, {3.770247371836048*^9, 
   3.770247372738474*^9}, {3.7702474314402304`*^9, 3.7702474385448656`*^9}, {
   3.770247481652176*^9, 3.7702474834885426`*^9}, {3.7702475249043355`*^9, 
   3.7702475321401134`*^9}, {3.770247564901678*^9, 3.770247613619937*^9}, {
   3.7702476861067753`*^9, 3.770247881044595*^9}, {3.7702479125639033`*^9, 
   3.7702479134822083`*^9}, {3.770247956571599*^9, 3.770247958254629*^9}, {
   3.770248001049197*^9, 3.7702480433839684`*^9}, {3.770248180807063*^9, 
   3.7702482490096135`*^9}, 3.7702482949683104`*^9, {3.770248535733263*^9, 
   3.770248536319704*^9}, {3.770248653480591*^9, 3.77024866006662*^9}, {
   3.7702487372024455`*^9, 3.77024880768093*^9}, {3.7702489007189465`*^9, 
   3.7702490396056585`*^9}, {3.770249091608136*^9, 3.770249148237818*^9}, {
   3.7702491966474657`*^9, 3.7702492082818403`*^9}, {3.770249241309782*^9, 
   3.7702492498189983`*^9}, {3.770249286857557*^9, 3.77024936405159*^9}, {
   3.7702494184405994`*^9, 3.7702498326861305`*^9}, {3.770250329098587*^9, 
   3.770250329384012*^9}, {3.7702532342961884`*^9, 3.770253259199847*^9}, {
   3.7702541214860315`*^9, 3.770254133057387*^9}, {3.7702547865161605`*^9, 
   3.770254847461046*^9}, {3.7702548876362495`*^9, 3.7702548915861416`*^9}, {
   3.770255498049836*^9, 3.7702555006106453`*^9}, {3.770255574723529*^9, 
   3.770255575726014*^9}, {3.7702556260175853`*^9, 3.7702561101731777`*^9}, {
   3.7702563716893663`*^9, 3.7702563719747057`*^9}, {3.7702564964876523`*^9, 
   3.77025650084613*^9}, {3.7702568533081603`*^9, 3.770257108565385*^9}, {
   3.7702572063370686`*^9, 3.770257325537154*^9}, {3.7702574070681868`*^9, 
   3.7702574834364796`*^9}, {3.770284082518015*^9, 3.770284089437547*^9}, {
   3.7702841198093486`*^9, 3.770284234020545*^9}, {3.77028428809661*^9, 
   3.770284288912603*^9}, {3.7702843234330583`*^9, 3.7702843495395937`*^9}, {
   3.7702844235072575`*^9, 3.770284731047119*^9}, {3.770284801109486*^9, 
   3.7702848420994463`*^9}, {3.770284906211549*^9, 3.770285052317601*^9}, {
   3.770285103657465*^9, 3.7702851747462196`*^9}, {3.7702852067736807`*^9, 
   3.7702855253652287`*^9}, {3.770286830864273*^9, 3.7702869264790926`*^9}, {
   3.770286960362752*^9, 3.770287030478304*^9}, {3.7702885577233086`*^9, 
   3.7702886257646155`*^9}, {3.770289012581577*^9, 3.7702890150573864`*^9}, 
   3.770290046519442*^9, {3.7702930561630163`*^9, 3.770293056347928*^9}, {
   3.7744318271796975`*^9, 
   3.774431833961543*^9}},ExpressionUUID->"0db9876a-9042-4f66-af7c-\
6f9b91b67bf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
    "**"}], "*******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Test", " ", "loop"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lambdalength", "=", "4"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"length", " ", "of", " ", "lambda"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdamaxentry", "=", "5"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"max", " ", "possible", " ", "entry", " ", "of", " ", "lambda"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambdarange", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Reverse", "/@", 
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "lambdalength", "}"}]}], "]"}], ",", 
           RowBox[{"Range", "[", "lambdamaxentry", "]"}]}], "]"}], ",", 
         RowBox[{"{", "lambdalength", "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"counter", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"counter", "++"}], ";", "\[IndentingNewLine]", 
       RowBox[{"schurp", "=", 
        RowBox[{"SchurPPolynomial", "[", "lambda", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"LorentzianPolynomialQ", "[", 
         RowBox[{"NormalizePolynomial", "[", "schurp", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "result"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Found a counterexample!\>\"", "<>", "\"\< Try \[Lambda]=\>\"", 
           "<>", 
           RowBox[{"ToString", "[", "lambda", "]"}], "<>", "\"\<.\>\""}], 
          "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"lambda", ",", "lambdarange"}], "}"}]}], "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "*******)"}]}]}]], "Input",
 CellChangeTimes->{{3.7702565249683948`*^9, 3.7702568308117075`*^9}, {
   3.7702571480006924`*^9, 3.770257151332902*^9}, {3.770257335999133*^9, 
   3.770257348033964*^9}, {3.770257384573245*^9, 3.770257387922423*^9}, 
   3.7702848883152137`*^9, {3.770285545061364*^9, 3.770285552868024*^9}, {
   3.770285596695321*^9, 3.7702856219474697`*^9}, {3.7702858298556004`*^9, 
   3.7702858984096627`*^9}, {3.7702859738011785`*^9, 
   3.7702859778106885`*^9}, {3.7702865816596565`*^9, 
   3.7702866154591675`*^9}, {3.7702870393026814`*^9, 
   3.7702871460851655`*^9}, {3.770287181708457*^9, 3.770287252965723*^9}, {
   3.770287283458208*^9, 3.7702874194401603`*^9}, {3.770287532419386*^9, 
   3.7702877096646204`*^9}, {3.7702877495329227`*^9, 
   3.7702877742334356`*^9}, {3.770287816414188*^9, 3.7702878181344385`*^9}, 
   3.770288335728823*^9, {3.770288370543077*^9, 3.770288436400756*^9}, {
   3.7702886812696476`*^9, 3.7702888668997283`*^9}, {3.7702889103620825`*^9, 
   3.7702889232198534`*^9}, {3.770288971589588*^9, 3.7702889728310537`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"8301db89-eedf-46e8-bd86-240604183c87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
    "**"}], "*******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Run", " ", "this", " ", "cell", " ", "in", " ", "subsession", " ", "to", 
    " ", "check", " ", "progress", " ", "of", " ", "loop"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"counter", ",", "\"\< out of \>\"", ",", " ", 
      RowBox[{"Length", "[", "lambdarange", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "*******)"}]}]}]], "Input",
 CellChangeTimes->{{3.7702866212604914`*^9, 3.7702866541061482`*^9}, {
  3.770287724914901*^9, 3.770287733033086*^9}, {3.7702889271990466`*^9, 
  3.7702889498501616`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"086f3f18-0bae-4658-8f2b-21a0229cf40c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "31", "\[InvisibleSpace]", "\<\" out of \"\>", "\[InvisibleSpace]", "31"}],
  SequenceForm[31, " out of ", 31],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7702866548081913`*^9, 3.770286661815076*^9}, {
   3.770287741637392*^9, 3.7702878035416517`*^9}, {3.7702878407740903`*^9, 
   3.7702878728275647`*^9}, {3.770288444821929*^9, 3.7702884613290367`*^9}, 
   3.7702885009559164`*^9, {3.770288933117544*^9, 3.7702889510003595`*^9}, {
   3.770293200189853*^9, 3.77029321001651*^9}},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"936abcce-7e34-4d60-a5dd-93930b9ec97e"]
}, Open  ]]
},
WindowSize->{1904, 997},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.8 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1233, 28, 145, "Input",ExpressionUUID->"64c7bbb2-096e-48f8-a349-50960e2bbb74",
 Evaluatable->False],
Cell[1794, 50, 43076, 1006, 5661, "Input",ExpressionUUID->"0db9876a-9042-4f66-af7c-6f9b91b67bf8"],
Cell[44873, 1058, 3813, 81, 527, "Input",ExpressionUUID->"8301db89-eedf-46e8-bd86-240604183c87"],
Cell[CellGroupData[{
Cell[48711, 1143, 1343, 28, 187, "Input",ExpressionUUID->"086f3f18-0bae-4658-8f2b-21a0229cf40c"],
Cell[50057, 1173, 640, 13, 40, "Print",ExpressionUUID->"936abcce-7e34-4d60-a5dd-93930b9ec97e"]
}, Open  ]]
}
]
*)

